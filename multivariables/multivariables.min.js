var ss,ssVariables;MultiVariable=function(){this.instances=[],document.addEventListener("DOMContentLoaded",function(){ss=atob(document.querySelector("input[name='SS']").value).split("|"),ssVariables=JSON.parse("{"+ss.pop().replace(/[A-Z][A-Z0-9]*/g,'"$&"').replace(/,/g,":").replace(/;/g,",")+"}");for(var e=0;e<this.instances.length;e++)(function(){for(var t=this.instances[e],i=t.filter instanceof RegExp?new RegExp(t.filter.source,t.filter.flags.replace(/g|^/i,"g")):null,r=t.replace instanceof RegExp?new RegExp(t.replace.source,t.replace.flags.replace(/g|^/i,"g")):null,n=document.querySelector("input#"+t.input),a=getNodeContent(".dark1border + div > div"),s=0;s<t.length;s++){var l=ssVariables[t.prefix+s];l&&(t.value+=t.deserialize?t.deserialize(l):String.fromCharCode(l))}n&&(n.maxLength=t.length,n.value=t.default,n.addEventListener("input",function(){var e={},r=this.value;i&&(this.value=r=r.replace(i,"")),t.transform&&(this.value=r=t.transform(r));for(var n=0;n<t.length;n++)e[t.prefix+n]=t.serialize?t.serialize(r.substr(n,1)):r.charCodeAt(n)||0;updateVariables(e)})),t.replace&&replaceTextNode(a,r,t.value)}).bind(this)()}.bind(this))},MultiVariableInstance=function(e,t){this.factory=t,this.default="string"==typeof e.default?e.default:null,this.filter=null,e.filter&&(e.filter instanceof RegExp?this.filter=e.filter:"string"==typeof e.filter&&e.filter in this.factory.dictionary.FILTER&&(this.filter=this.factory.dictionary.FILTER[e.filter])),this.input="string"==typeof e.input?e.input:null,this.length=parseInt(e.length)||8,this.prefix="string"==typeof e.prefix&&/^[A-Z]/i.test(e.prefix)?e.prefix.toUpperCase():"MULTIVARIABLE"+this.factory.instances.length,this.replace=null,e.replace&&(e.replace instanceof RegExp?this.replace=e.replace:"string"==typeof e.replace&&(this.replace=new RegExp(e.replace.replace(/[-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")))),this.transform=null,e.transform&&("function"==typeof e.transform?this.transform=e.transform:"string"==typeof e.transform&&e.transform in this.factory.dictionary.TRANSFORM&&(this.transform=this.factory.dictionary.TRANSFORM[e.transform])),this.value="","function"==typeof e.deserialize&&"function"==typeof e.serialize?(this.deserialize=e.deserialize,this.serialize=e.serialize):this.deserialize=this.serialize=null},MultiVariable.prototype.add=function(e){var t=new MultiVariableInstance(e,this);return this.instances.push(t),this},MultiVariable.prototype.create=function(e){var t=new MultiVariableInstance(e,this);return this.instances.push(t)},MultiVariable.prototype.entries=function(){return this.instances},MultiVariable.prototype.get=function(e){return this.instances[e]},MultiVariable.prototype.dictionary={FILTER:{INTEGER:/(?!^-|[\d])./,NATURAL:/[^\d]/,NAME:/^[-']|[^-'a-zA-Z]/,NAME_INTERNATIONAL:/^[-']|[^-'a-zA-ZÀ-ÖØ-öø-ÿ]/},TRANSFORM:{LOWER:function(e){return e.toLowerCase()},NAME:function(e){return e.toLowerCase().replace(/(^|-)(.)/g,function(e,t,i){return t+i.toUpperCase()})},UPPER:function(e){return e.toUpperCase()}}},getNodeContent=function(e){return[].slice.call(document.querySelectorAll(e+", "+e+" *")).reduce(function(e,t){return e.concat([].slice.call(t.childNodes))},[])},replaceTextNode=function(e,t,i){for(var r=e.filter(function(e){return 3==e.nodeType&&e.nodeValue.trim()&&t.test(e.data)}),n=0;n<r.length;n++){var a=document.createElement("div"),s=r[n];for(a.innerHTML=s.data.replace(t,i);a.firstChild;)s.parentNode.insertBefore(a.firstChild,s);s.parentNode.removeChild(s)}},updateVariables=function(e){Object.assign(ssVariables,e)},applySS=function(){document.querySelector("input[name='SS']").value=btoa(ss.concat(Object.entries(ssVariables).map(function(e){return e.join(",")}).join(";")).join("|"))},PostBack=function(e,t){applySS();var i=getEl("pbForm");return i.pbAction.value=e||"",i.pbValue.value=t||"",i.submit(),!1};